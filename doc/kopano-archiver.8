.TH "KOPANO\-ARCHIVER" "8" "November 2016" "Kopano 8" "Kopano Core user reference"
.\" http://bugs.debian.org/507673
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.SH "NAME"
kopano-archiver \- Manages kopano archives and performs the archive operation.
.SH "SYNOPSIS"
.HP \w'\fBkopano\-archiver\fR\ 'u
\fBkopano\-archiver\fR [\fIOPTION\fR...]
.SH "DESCRIPTION"
.PP
This tool is used to attach or detach archives to a users store. An archive is defined as a special non\-active store or a folder inside such a store.
.PP
On top of managing archives, this tool is used to perform the actual archive operation. Using the
\fI\-u\fR
option, the archiver can be instructed to archive a single store or all stores.
.SH "ACTIONS"
.PP
kopano\-archiver needs an action command with the appropriate options. Valid actions are:
.PP
\fB\-l\fR, \fB\-\-list\fR
.RS 4
List archives for the specified user. The
\fI\-u\fR
option is required.
.RE
.PP
\fB\-L\fR, \fB\-\-list\-archiveusers\fR
.RS 4
List users that have an archive attached.
.RE
.PP
\fB\-A\fR, \fB\-\-archive\fR
.RS 4
Perform an archive run. If a
\fI\-u\fR
option is provided, only the store of one user will be archived. Otherwise all stores are archived. Optionally the
\fI\-\-local\-only\fR
option can be set to only archive stores that exist on the server to which kopano\-archiver is connected (usually the local server).
.RE
.PP
\fB\-C\fR, \fB\-\-cleanup\fR
.RS 4
Perform an archive cleanup run. If a
\fI\-u\fR
option is provided, only the archives of one user will be cleaned. Otherwise all stores are cleaned. Optionally the
\fI\-\-local\-only\fR
option can be set to only cleanup archives of users that have their primary store on the server to which kopano\-archiver is connected (usually the local server).
.RE
.PP
\fB\-a\fR \fIarchive\fR, \fB\-\-attach\-to\fR \fIarchive\fR
.RS 4
Attach an archive to the store of the user specified with the
\fI\-u\fR
option. If no additional options are specified, a folder will be created in the archive store, which will act as the root of the archive for the user. The foldername will be set to the username of the user. This behavior can be changed by providing the
\fI\-\-archive\-folder \fR
or
\fI\-\-no\-folder\fR
option.
.RE
.PP
\fB\-d\fR \fIarchive\fR, \fB\-\-detach\-from\fR \fIarchive\fR
.RS 4
Detach an archive from the store of the user specified with the
\fI\-u\fR
option. kopano\-archiver will automatically determine which folder to detach. However if a user has two archives in one archive store, kopano\-archiver won\*(Aqt be able to tell which one needs to be detached. In this case the folder needs to be specified with the
\fI\-\-archive\-folder\fR
option.
.RE
.PP
\fB\-D\fR \fIarchiveno\fR, \fB\-\-detach\fR \fIarchiveno\fR
.RS 4
Detach an archive from the store of the user specified with the
\fI\-u\fR
option. The archive to detach is indicated by archiveno and can be obtained by running
\fBkopano\-archiver\fR
\fB\-u\fR
\fIusername\fR
\fB\-l\fR
.RE
.PP
\fB\-\-auto\-attach\fR
.RS 4
When no user is specified with \-u, all users will have their archives attached or detached based on the LDAP/ADS settings. If a user is specified only that user\*(Aqs store will be processed. This option can be combined with
\fI\-A\fR
to force an auto\-attach run regardless of the
\fIenable_auto_attach\fR
configuration option.
.RE
.PP
\fB\-\-dump\-config\fP
.RS 4
Displays the values of \fBarchiver.cfg\fP configuration parameters and the
implied defaults.
.RE
.SH "OPTIONS"
.PP
The options used by actions are as follows:
.PP
\fB\-u\fR \fIusername\fR
.RS 4
Use this parameter to specify a user on which store to perform the provided action.
.RE
.PP
\fB\-\-local\-only\fR
.RS 4
If this option is passed when an archive run is started, only stores that exist on the server to which kopano\-archiver is connected will be archived.
.RE
.PP
\fB\-\-archive\-folder\fR \fIfoldername\fR
.RS 4
Use this option to force kopano\-archiver to create the archive folder with a different name than the username of the user for whom to attach an archive.
.RE
.PP
\fB\-\-archive\-server\fR \fIserverpath\fR
.RS 4
Use this option to specify the path to the archive server. This is useful when using the archiver in a non\-multiserver setup.
.RE
.PP
\fB\-\-no\-folder\fR
.RS 4
Use this option to force kopano\-archiver to create the root of the archive in the root of the archive store (IPM subtree). This way only one user store can be attached to an archive.
.RE
.PP
\fB\-w\fR
.RS 4
By default kopano\-archiver makes an archive read\-only for the user. By passing this option, the user will get read/write permissions in the attached archive.
.sp
This will override the
\fIauto_attach_writable \fR
configuration options when auto attaching archives.
.RE
.PP
\fB\-\-writable\fR \fIyes|no\fR
.RS 4
Explicitly enable or disable write permissions when (auto) attaching archives.
.sp
This will override the
\fIauto_attach_writable \fR
configuration options when auto attaching archives.
.RE
.PP
\fB\-c\fR \fIfile\fR
.RS 4
Select an alternate config file to be used by kopano\-archiver.
.sp
Default:
\fI/etc/kopano/archiver.cfg\fR
.RE
.SH "EXAMPLES"
.PP
For attaching an archive:
.PP
\fBkopano\-archiver\fR
\fB\-u\fR
\fIusername\fR
\fB\-\-attach\-to\fR
\fIarchive\fR
.PP
For attaching an archive with a custom archive name:
.PP
\fBkopano\-archiver\fR
\fB\-u\fR
\fIusername\fR
\fB\-\-attach\-to\fR
\fIarchive\fR
\fB\-\-archive\-name\fR
\fIarchivename\fR
.PP
For attaching an archive without an archive folder:
.PP
\fBkopano\-archiver\fR
\fB\-u\fR
\fIusername\fR
\fB\-\-attach\-to\fR
\fIarchive\fR
\fB\-\-no\-folder\fR
.PP
For detaching an archive:
.PP
\fBkopano\-archiver\fR
\fB\-u\fR
\fIusername\fR
\fB\-\-detach\-from\fR
\fIarchive\fR
.PP
For starting an archive run:
.PP
\fBkopano\-archiver\fR
\fB\-A\fR
.PP
For starting an archive run for one user:
.PP
\fBkopano\-archiver\fR
\fB\-u\fR
\fIusername\fR
\fB\-A\fR
.PP
For starting a cleanup run:
.PP
\fBkopano\-archiver\fR
\fB\-C\fR
.PP
For starting a cleanup run for one user:
.PP
\fBkopano\-archiver\fR
\fB\-u\fR
\fIusername\fR
\fB\-C\fR
.SH "SEE ALSO"
.PP
\fBkopano-server\fR(8),
\fBkopano-archiver.cfg\fR(5)
